// Actors based on and forked from "Delashin's Smooth Doom Remake"
// v0 uses both stop-based logic: actors check CVars once on spawn, then stop
// Changing CVars requires level reload to spawn new actors with updated values

ACTOR NewStimpack : Stimpack replaces Stimpack
{
    states
    {
        Spawn:
            TNT1 A 0  // Invisible placeholder frame
            TNT1 A 0 A_JumpIf(CallACS("STIMOptions")==1, "Green")  // Check CVar: Green variant?
            TNT1 A 0 A_JumpIf(CallACS("STIMOptions")==2, "Pills")  // Check CVar: Pills variant?
            TNT1 A 0 A_JumpIf(CallACS("64StylePickups")==1, "64Spawn")  // Check 64-style toggle (inherited from base mod)
            RSTM A -1  // Default red stimpack sprite (custom, not WAD default) - infinite duration
            stop  // CRITICAL: No loop - actor frozen at this sprite until level reload
        Green:
            GSTM A -1  // Green variant sprite
            stop
        Pills:
            PSTM A -1  // Pills variant sprite
            stop
        64Spawn:
            HS64 A -1  // DOOM 64 style sprite
            stop
    }
}

ACTOR NewMedikit : Medikit replaces Medikit
{
    states
    {
        Spawn:
            TNT1 A 0
            TNT1 A 0 A_JumpIf(CallACS("MEDOptions")==1, "Green")
            TNT1 A 0 A_JumpIf(CallACS("MEDOptions")==2, "Pills")
            TNT1 A 0 A_JumpIf(CallACS("64StylePickups")==1, "64Spawn")
            RMED A -1  // Default red medikit (custom sprite)
            stop
        Green:
            GMED A -1
            stop
        Pills:
            PMED A -1
            stop
        64Spawn:
            HL64 A -1
            stop
    }
}

ACTOR PerkBerserk : Berserk replaces Berserk
{
    States
    {
        Spawn:
            TNT1 A 0
            TNT1 A 0 A_JumpIf(CallACS("BERZOptions")==1, "Green")
            TNT1 A 0 A_JumpIf(CallACS("BERZOptions")==2, "Pills")
            TNT1 A 0 A_JumpIf(CallACS("64StylePickups")==1, "64Spawn")
            RPST A -1  // Default red berserk (custom sprite)
            stop
        Green:
            TNT1 A 0
            GPST A -1
            stop
        Pills:
            TNT1 A 0
            PPST A -1
            stop
        64Spawn:
            TNT1 A 0
            BK64 A -1
            stop
        Pickup:
            // Custom pickup logic required for Berserk to function correctly
            // (inherited from base mod - standard Berserk inheritance didn't work properly)
            TNT1 A 0 A_GiveInventory("PowerStrength")
            TNT1 A 0 HealThing(100, 0)
            TNT1 A 0 A_SelectWeapon("PerkFist")
            Stop
    }
}